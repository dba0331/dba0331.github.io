"use strict";(self.webpackChunkjitdba_site=self.webpackChunkjitdba_site||[]).push([[826],{8607:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>c,metadata:()=>d,toc:()=>a});var n=i(4848),o=i(8453),r=i(6113);const c={sidebar_position:1,title:"\u67e5\u8be2min\u51fd\u6570\u6162"},s=void 0,d={id:"2\u5b9e\u4f8b\u7ba1\u7406\u4e0e\u4f18\u5316/2TiKV\u5b9e\u4f8b/GC\u4e0eCompaction/\u6848\u4f8b/\u67e5\u8be2min\u51fd\u6570\u6162",title:"\u67e5\u8be2min\u51fd\u6570\u6162",description:"\u793a\u610f\u56fe",source:"@site/docs/2\u5b9e\u4f8b\u7ba1\u7406\u4e0e\u4f18\u5316/2TiKV\u5b9e\u4f8b/GC\u4e0eCompaction/\u6848\u4f8b/\u67e5\u8be2min\u51fd\u6570\u6162.md",sourceDirName:"2\u5b9e\u4f8b\u7ba1\u7406\u4e0e\u4f18\u5316/2TiKV\u5b9e\u4f8b/GC\u4e0eCompaction/\u6848\u4f8b",slug:"/2\u5b9e\u4f8b\u7ba1\u7406\u4e0e\u4f18\u5316/2TiKV\u5b9e\u4f8b/GC\u4e0eCompaction/\u6848\u4f8b/\u67e5\u8be2min\u51fd\u6570\u6162",permalink:"/docs/2\u5b9e\u4f8b\u7ba1\u7406\u4e0e\u4f18\u5316/2TiKV\u5b9e\u4f8b/GC\u4e0eCompaction/\u6848\u4f8b/\u67e5\u8be2min\u51fd\u6570\u6162",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"\u67e5\u8be2min\u51fd\u6570\u6162"},sidebar:"tidbSidebar",previous:{title:"tikv\u4e3b\u8981\u7ec4\u4ef6",permalink:"/docs/2\u5b9e\u4f8b\u7ba1\u7406\u4e0e\u4f18\u5316/2TiKV\u5b9e\u4f8b/1tikv\u4e3b\u8981\u7ec4\u4ef6"},next:{title:"gc safepoint\u4e0d\u63a8\u8fdb",permalink:"/docs/2\u5b9e\u4f8b\u7ba1\u7406\u4e0e\u4f18\u5316/2TiKV\u5b9e\u4f8b/GC\u4e0eCompaction/\u6848\u4f8b/gc safepoint\u4e0d\u63a8\u8fdb"}},l={},a=[{value:"\u8bf4\u660e",id:"\u8bf4\u660e",level:2},{value:"\u68c0\u7d22\u7528\u8bcd(\u67e5\u8be2min\u51fd\u6570\u6162)",id:"\u68c0\u7d22\u7528\u8bcd\u67e5\u8be2min\u51fd\u6570\u6162",level:2}];function m(e){const t={code:"code",h2:"h2",p:"p",...(0,o.R)(),...e.components},{Details:i}=t;return i||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"\u793a\u610f\u56fe"}),"\n","\n",(0,n.jsx)(r.A,{children:"/img/2\u5b9e\u4f8b\u7ba1\u7406\u4e0e\u4f18\u5316/2TiKV\u5b9e\u4f8b/GC\u4e0eCompaction/\u6848\u4f8b/\u67e5\u8be2min\u51fd\u6570\u6162.svg "}),"\n",(0,n.jsx)(t.h2,{id:"\u8bf4\u660e",children:"\u8bf4\u660e"}),"\n",(0,n.jsx)(t.h2,{id:"\u68c0\u7d22\u7528\u8bcd\u67e5\u8be2min\u51fd\u6570\u6162",children:"\u68c0\u7d22\u7528\u8bcd(\u67e5\u8be2min\u51fd\u6570\u6162)"}),"\n",(0,n.jsxs)(i,{children:[(0,n.jsx)("summary",{children:"used by local search"}),(0,n.jsx)("div",{children:(0,n.jsxs)(t.p,{children:["dt\u6709\u7d22\u5f15, tidb\u5185\u90e8\u628amin\u6539\u5199\u4e3a:\nselect t order by dt limit 1\n\u7406\u8bba\u4e0atikv\u53ea\u8bfb\u53d6\u6709\u6548\u7684\u7b2c\u4e00\u6761,, \u4f46tikv\u4ece\u7d22\u5f15\u5934\u90e8\u626b\u63cf\u8d77,, \u9700\u8981\u8df3\u8fc75000\u4e07\u6761mvcc\u6570\u636e,, sql\u6267\u884c\u4fe1\u606f\u4e2d\u7684skip count\u6709\u8bb0\u5f55, \u53d8\u6210mvcc\u6570\u636e, \u4fdd\u7559\u5728\u8868\u4e2d, compaction, _filter\u53c2\u6570?, \u4fdd\u7559\u65f6\u95f4\u8d85\u51fagc life, delete\u7684\u6570\u636e, \u771f\u6b63\u4ece\u78c1\u76d8\u62b9\u53bb, delete\u6570\u636e, \u7531rocksdb\u5728, compaction\u65f6, \u4e00\u8d77\u6e05\u7406, \u9ed8\u8ba4true, gc worker, \u6807\u8bb0\u4e3atomestone, false, \u7406\u8bba\u56de\u987e, \u6848\u4f8b, \u7136\u540e\u67e5\u8be2, \u82b1\u4e86\u4e00\u5206\u949f, select min(dt) from t, \u89e3\u51b3\u529e\u6cd5, \u6e05\u7406\u7684\u65f6\u95f4\u63d0\u524d, \u6216\u67e5\u8be2\u65f6\u523b\u5ef6\u540e, select min(dt) from t, \u6b64\u65f6dt\u7d22\u5f15\u5934\u90e8\u6ca1\u6709mvcc\u6570\u636e, \u67e5\u8be2min\u53ea\u9700\u8bfb\u7d22\u5f15\u7b2c\u4e00\u4e2aregion, \u5c31\u5927\u6982\u7387\u80fd\u53d6\u5f97\u6709\u6548\u6570\u636e,\n\u5148\u6e05\u740630\u5929\u524d\u6570\u636e5\u5343\u4e07\u6761\n",(0,n.jsx)(t.code,{children:"delete t where dt<30\u5929\u524d"})]})})]})]})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(m,{...e})}):m(e)}},6113:(e,t,i)=>{i.d(t,{A:()=>r});var n=i(6540),o=i(4848);class r extends n.Component{componentDidMount(){$("#graph").graphviz({url:this.props.children,ready:function(){var e=this;e.nodes().click((function(){var t=$();t.push(this),t=(t=t.add(e.linkedFrom(this,!0))).add(e.linkedTo(this,!0)),e.highlight(t,!0),e.bringToFront(t)})),$(document).keydown((function(t){27==t.keyCode&&e.highlight()})),$("#graph")[0].addEventListener("click",(function(){e.highlight()}),!0)}})}render(){return(0,o.jsx)("div",{id:"graph",children:" "})}}},8453:(e,t,i)=>{i.d(t,{R:()=>c,x:()=>s});var n=i(6540);const o={},r=n.createContext(o);function c(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);