"use strict";(self.webpackChunkjitdba_site=self.webpackChunkjitdba_site||[]).push([[7636],{7399:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>c,contentTitle:()=>s,default:()=>a,frontMatter:()=>o,metadata:()=>l,toc:()=>r});var d=i(4848),t=i(8453);const o={},s=void 0,l={id:"4SQL\u4e0e\u4f18\u5316/2\u8bed\u53e5\u4f18\u5316/\u6848\u4f8b/\u4e0d\u8d70IndexJoin-4-\u9ad8\u4f30\u5185\u88681",title:"\u4e0d\u8d70IndexJoin-4-\u9ad8\u4f30\u5185\u88681",description:"\u539f\u6267\u884c\u8ba1\u5212",source:"@site/docs/4SQL\u4e0e\u4f18\u5316/2\u8bed\u53e5\u4f18\u5316/\u6848\u4f8b/\u4e0d\u8d70IndexJoin-4-\u9ad8\u4f30\u5185\u88681.md",sourceDirName:"4SQL\u4e0e\u4f18\u5316/2\u8bed\u53e5\u4f18\u5316/\u6848\u4f8b",slug:"/4SQL\u4e0e\u4f18\u5316/2\u8bed\u53e5\u4f18\u5316/\u6848\u4f8b/\u4e0d\u8d70IndexJoin-4-\u9ad8\u4f30\u5185\u88681",permalink:"/docs/4SQL\u4e0e\u4f18\u5316/2\u8bed\u53e5\u4f18\u5316/\u6848\u4f8b/\u4e0d\u8d70IndexJoin-4-\u9ad8\u4f30\u5185\u88681",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tidbSidebar",previous:{title:"\u4e0d\u8d70IndexJoin-3-\u9690\u5f0f\u8f6c\u6362",permalink:"/docs/4SQL\u4e0e\u4f18\u5316/2\u8bed\u53e5\u4f18\u5316/\u6848\u4f8b/\u4e0d\u8d70IndexJoin-3-\u9690\u5f0f\u8f6c\u6362"},next:{title:"\u4e0d\u8d70IndexJoin-4-\u9ad8\u4f30\u5185\u88682",permalink:"/docs/4SQL\u4e0e\u4f18\u5316/2\u8bed\u53e5\u4f18\u5316/\u6848\u4f8b/\u4e0d\u8d70IndexJoin-4-\u9ad8\u4f30\u5185\u88682"}},c={},r=[{value:"\u539f\u6267\u884c\u8ba1\u5212",id:"\u539f\u6267\u884c\u8ba1\u5212",level:2},{value:"\u5206\u6790",id:"\u5206\u6790",level:3},{value:"\u7ed3\u8bba",id:"\u7ed3\u8bba",level:3},{value:"\u4f18\u5316\u5efa\u8bae",id:"\u4f18\u5316\u5efa\u8bae",level:2},{value:"\u53c2\u8003\u4fe1\u606f",id:"\u53c2\u8003\u4fe1\u606f",level:2}];function x(n){const e={admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...n.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.h2,{id:"\u539f\u6267\u884c\u8ba1\u5212",children:"\u539f\u6267\u884c\u8ba1\u5212"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"or\u8bed\u53e5",src:i(5036).A+"",width:"1200",height:"312"})}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-sql",children:"-- \u8bed\u53e5\u7c7b\u4f3c\u4e8e\nselect ...\nfrom tmp left join idx\non  tmp.id = idx.id\n  and tmp.col1 = idx.col1\n  and tmp.col2 = idx.col2\ngroup by tmp.id\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u5206\u6790",children:"\u5206\u6790"}),"\n",(0,d.jsx)(e.p,{children:"tmp\u8868\u5b9e\u96450\u6761, idx\u8868388\u4e07, \u539fplan\u6709\u51e0\u4e2a\u7279\u70b9"}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"tmp\u7edf\u8ba1\u4fe1\u606f\u672a\u66f4\u65b0, \u8fd8\u662f\u8001\u76848775;"}),"\n",(0,d.jsx)(e.li,{children:"\u4f18\u5316\u5668\u8ba4\u4e3a\u8d70 IndexJoin, \u5185\u8868idx\u8981\u8bfb\u53d65060\u4e07\u6761(\u53c2\u89c1\u540e\u9762\u7684\u8ba1\u5212), \u6240\u4ee5\u6700\u540e\u9009\u4e86HashJoin (cost\u4f4e);"}),"\n"]}),"\n",(0,d.jsx)(e.h3,{id:"\u7ed3\u8bba",children:"\u7ed3\u8bba"}),"\n",(0,d.jsx)(e.p,{children:"\u8fd9\u91cc\u7684\u4e3b\u8981\u95ee\u9898\u662f\u9ad8\u4f30\u4e86INL\u65f6\u5185\u8868idx\u8981\u8bfb\u53d6\u7684\u6761\u6570\u3002"}),"\n",(0,d.jsxs)(e.admonition,{type:"tip",children:[(0,d.jsxs)(e.p,{children:["\u4e24\u8868\u4e4b\u95f4\u7528\u591a\u4e2a\u5b57\u6bb5\u8fdb\u884c\u8868\u5173\u8054\u65f6(\u5982\u4e0a\u9762\u6709 id, col1, col2), \u66f4\u5bb9\u6613\u53d1\u751f\u9ad8\u4f30\u3002",(0,d.jsx)(e.br,{}),"\n","\u9632\u6b62\u4f18\u5316\u5668\u9ad8\u4f30INL\u4e2d\u5185\u8868\u7684\u6761\u6570, \u53ef\u4ee5\u8bbe\u7f6e:"]}),(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsxs)(e.p,{children:["SET SESSION tidb_opt_fix_control = '44855",":ON","'"]}),"\n"]})]}),"\n",(0,d.jsx)(e.h2,{id:"\u4f18\u5316\u5efa\u8bae",children:"\u4f18\u5316\u5efa\u8bae"}),"\n",(0,d.jsx)(e.p,{children:"\u52a0hint, \u8d70 tmp IndexJoin idx\u3002"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-sql",children:"-- \u8bed\u53e5\u7c7b\u4f3c\u4e8e\nselect /*+ inl_join(idx) */\n...\nfrom tmp left join idx\non  tmp.id = idx.id\n  and tmp.col1 = idx.col1\n  and tmp.col2 = idx.col2\ngroup by tmp.id\n"})}),"\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.img,{alt:"or\u8bed\u53e5",src:i(1483).A+"",width:"800",height:"253"}),"\n\u6539\u5b8c\u540e\uff0c\u6709\u4ee5\u4e0b\u51e0\u4e2a\u7279\u70b9"]}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"\u56e0\u4e3atmp\u8fd4\u56de0\u6761, \u6240\u4ee5\u4e0d\u518d\u8bbf\u95eeidx\u8868"}),"\n"]}),"\n",(0,d.jsx)(e.h2,{id:"\u53c2\u8003\u4fe1\u606f",children:"\u53c2\u8003\u4fe1\u606f"}),"\n",(0,d.jsx)(e.p,{children:"\u7edf\u8ba1\u4fe1\u606f\u4e0d\u51c6\u7684\u53ef\u80fd\u539f\u56e0:"}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"\u5c0f\u4e8e1000\u6761\u7684\u5c0f\u8868\u4e0d\u81ea\u52a8\u6536\u96c6"}),"\n",(0,d.jsx)(e.li,{children:"\u6ca1\u6709\u673a\u4f1a\u81ea\u52a8\u6536\u96c6, \u56e0\u4e3a\u81ea\u52a8\u6536\u96c6\u4efb\u52a1\u88ab\u5176\u5b83\u9891\u7e41\u66f4\u65b0\u7684\u8868\u6240\u5360\u7528"}),"\n"]})]})}function a(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,d.jsx)(e,{...n,children:(0,d.jsx)(x,{...n})}):x(n)}},5036:(n,e,i)=>{i.d(e,{A:()=>d});const d=i.p+"assets/images/\u4e0d\u8d70IndexJoin-4-\u9ad8\u4f30\u5185\u88681-48d78189c2b7df52425804c6059c27b5.jpg"},1483:(n,e,i)=>{i.d(e,{A:()=>d});const d=i.p+"assets/images/\u4e0d\u8d70IndexJoin-4-\u9ad8\u4f30\u5185\u88682-7d2dca014e7ec97fc92ea774be799a50.jpg"},8453:(n,e,i)=>{i.d(e,{R:()=>s,x:()=>l});var d=i(6540);const t={},o=d.createContext(t);function s(n){const e=d.useContext(o);return d.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:s(n.components),d.createElement(o.Provider,{value:e},n.children)}}}]);