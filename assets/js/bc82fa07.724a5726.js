"use strict";(self.webpackChunkjitdba_site=self.webpackChunkjitdba_site||[]).push([[6968],{6761:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>c,toc:()=>l});var s=t(4848),a=t(8453);const r={sidebar_position:8},i=void 0,c={id:"4SQL\u4e0e\u4f18\u5316/1\u6267\u884c\u8ba1\u5212/\u63d0\u524d\u8ba1\u7b97\u7684\u5b50\u67e5\u8be2",title:"\u63d0\u524d\u8ba1\u7b97\u7684\u5b50\u67e5\u8be2",description:"\u73af\u5883\u51c6\u5907",source:"@site/docs/4SQL\u4e0e\u4f18\u5316/1\u6267\u884c\u8ba1\u5212/\u63d0\u524d\u8ba1\u7b97\u7684\u5b50\u67e5\u8be2.md",sourceDirName:"4SQL\u4e0e\u4f18\u5316/1\u6267\u884c\u8ba1\u5212",slug:"/4SQL\u4e0e\u4f18\u5316/1\u6267\u884c\u8ba1\u5212/\u63d0\u524d\u8ba1\u7b97\u7684\u5b50\u67e5\u8be2",permalink:"/docs/4SQL\u4e0e\u4f18\u5316/1\u6267\u884c\u8ba1\u5212/\u63d0\u524d\u8ba1\u7b97\u7684\u5b50\u67e5\u8be2",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8},sidebar:"tidbSidebar",previous:{title:"\u8ba1\u5212-UnionScan",permalink:"/docs/4SQL\u4e0e\u4f18\u5316/1\u6267\u884c\u8ba1\u5212/\u8ba1\u5212-UnionScan"},next:{title:"v6.5\u4e2dCTE\u5c55\u5f00\u7684\u95ee\u9898",permalink:"/docs/4SQL\u4e0e\u4f18\u5316/1\u6267\u884c\u8ba1\u5212/CTE\u8bed\u53e5/v6.5\u4e2dCTE\u5c55\u5f00\u7684\u95ee\u9898"}},d={},l=[{value:"\u5982\u679c\u5b50\u67e5\u8be2\u5f88\u6162",id:"\u5982\u679c\u5b50\u67e5\u8be2\u5f88\u6162",level:2},{value:"\u4e00\u4e2a\u5999\u7528",id:"\u4e00\u4e2a\u5999\u7528",level:2}];function o(e){const n={br:"br",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"\u73af\u5883\u51c6\u5907"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"create table a (id int, name varchar(20));\ncreate table b (id int, name varchar(20));\ninsert into a values(1, 'a');\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e0b\u9762\u63d0\u524d\u8ba1\u7b97\u4e86CTE\u7684\u503c, \u6240\u4ee5where\u6761\u4ef6\u662fname='a'"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"explain analyze\nwith tmp as (select name from a where id=1)\nselect * from b where name = (select name from tmp)\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"\u63d0\u524d\u8ba1\u7b97\u7684\u5b50\u67e5\u8be21",src:t(549).A+"",width:"552",height:"88"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e0b\u9762\u63d0\u524d\u8ba1\u7b97\u4e86CTE\u7684\u503c\u4e3anull, \u6240\u4ee5where name=null\u88ab\u7b80\u5316\u4e3aTableDual\u7a7a\u8868"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"explain analyze\nwith tmp as (select name from a where id=10) -- \u4e0d\u5b58\u5728\nselect * from b where name = (select name from tmp)\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"\u63d0\u524d\u8ba1\u7b97\u7684\u5b50\u67e5\u8be22",src:t(2718).A+"",width:"539",height:"51"})}),"\n",(0,s.jsx)(n.h2,{id:"\u5982\u679c\u5b50\u67e5\u8be2\u5f88\u6162",children:"\u5982\u679c\u5b50\u67e5\u8be2\u5f88\u6162"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"insert S\nselect ... from S\nwhere \ndt = (select max(dt) from S)\nand not exists(select 1 from S where dt='xxx')\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5982\u679cS\u8868\u5f88\u5927, \u8ba1\u7b97\u5b50\u67e5\u8be2\u7684\u65f6\u95f4\u957f, \u4f1a\u51fa\u73b0\u4ee5\u4e0b\u73b0\u8c61, plan\u4e2d\u624d14s, \u4f46\u6574\u4f53\u65f6\u95f45.6\u5206\u949f:",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{alt:"\u63d0\u524d\u8ba1\u7b97\u7684\u5b50\u67e5\u8be23",src:t(1111).A+"",width:"1200",height:"1143"})]}),"\n",(0,s.jsx)(n.h2,{id:"\u4e00\u4e2a\u5999\u7528",children:"\u4e00\u4e2a\u5999\u7528"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"select part.* from part, T\nwhere \npart.dt = T.dt\nand part.id = T.id\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5206\u533a\u8868part\u6309\u65e5\u671fdt\u5b57\u6bb5\u5206\u533a, id\u4e0a\u6709\u7d22\u5f15, \u5c0f\u8868T\u4e2d\u6ca1\u51e0\u4e2a\u65e5\u671f\u3002",(0,s.jsx)(n.br,{}),"\n","\u539f\u59cb\u8ba1\u5212\u662f T hashjoin part(\u5168\u5206\u533a\u626b\u63cf)"]}),"\n",(0,s.jsx)(n.p,{children:"\u7ed9sql\u52a0\u4e2a\u5197\u4f59\u6761\u4ef6, \u5b9e\u73b0part\u7684\u5206\u533a\u526a\u88c1"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"select part.* from part, T\nwhere \npart.dt = T.dt\nand part.id = T.id\nand part.dt <= (select max(dt) from T) -- max\u503c\u4f1a\u63d0\u524d\u88ab\u8ba1\u7b97\u51fa\u6765\u4f5c\u4e3a\u5e38\u91cf\n\xb7\xb7\xb7\n\n\n\n\n\n\n"})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},549:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/\u63d0\u524d\u8ba1\u7b97\u7684\u5b50\u67e5\u8be21-70665bb349fdd274daea3c70fd505233.png"},2718:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/\u63d0\u524d\u8ba1\u7b97\u7684\u5b50\u67e5\u8be22-3f0713e62fb37bc63bf08085634fdfa5.png"},1111:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/\u63d0\u524d\u8ba1\u7b97\u7684\u5b50\u67e5\u8be23-a7c9cd0e9a23c5f2fb771e844bdd0691.jpg"},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>c});var s=t(6540);const a={},r=s.createContext(a);function i(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);